<#@ template debug="false" hostspecific="false" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".cs" #>

<#
	(string, string)[] tuples =
	{
		// NOTE: NullExceptionTests are the hand-written tests, upon which this code generation template is based.
		//("Null", "is null"),
		("CollectionEmpty", "collection is empty"),
		("CollectionNotEmpty", "collection should be empty"),
		("HasNulls", "contains nulls"),
		("HasValue", "should not have a value"),
		("Infinity", "is Infinity"),
		("InvalidReference", "not found in list"),
		("IsDateTime", "should not be a DateTime"),
		("IsDecimal", "should not be a Decimal"),
		("IsDouble", "should not be a double precision floating point number"),
		("IsInteger", "should not be an integer number"),
		("NaN", "is NaN"),
		("NotDateTime", "is not a DateTime"),
		("NotDecimal", "is not a Decimal"),
		("NotDouble", "is not a double precision floating point number"),
		("NotHasValue", "has no value"),
		("NotInfinity", "should be Infinity"),
		("NotInteger", "is not an integer number"),
		("NotNaN", "should be NaN"),
		("NotNull", "should be null"),
		("NotNullOrEmpty", "should be null or empty"),
		("NotNullOrWhiteSpace", "should be null or white space"),
		("NullOrEmpty", "is null or empty"),
		("NullOrWhiteSpace", "is null or white space"),
		("Zero", "is 0")
	};
#>

using JJ.Framework.Testing;
using Microsoft.VisualStudio.TestTools.UnitTesting;
// ReSharper disable LocalNameCapturedOnly

namespace JJ.Framework.Exceptions.Tests
{
	[TestClass]
	public class SimpleExceptionTests
	{
		<# foreach ((string codeName, string displayText) in tuples) { #>

			[TestMethod]
			public void Test_<#= codeName #>Exception_WithNameOf()
			{
				AssertHelper.ThrowsException<<#= codeName #>Exception>(
					() =>
					{
						object value;

						throw new <#= codeName #>Exception(nameof(value));
					},
					"value <#= displayText #>.");
			}

			[TestMethod]
			public void Test_<#= codeName #>Exception_WithExpression_WithSinglePart()
			{
				AssertHelper.ThrowsException<<#= codeName #>Exception>(
					() =>
					{
						object value = null;

						throw new <#= codeName #>Exception(() => value);
					},
					"value <#= displayText #>.");
			}

			[TestMethod]
			public void Test_<#= codeName #>Exception_WithExpression_WithMultipleParts()
			{
				AssertHelper.ThrowsException<<#= codeName #>Exception>(
					() =>
					{
						TestItem item = null;

						throw new <#= codeName #>Exception(() => item.Parent);
					},
					"item.Parent <#= displayText #>.");
			}

		<# } #>

	}
}